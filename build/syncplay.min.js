!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_FACTORY__;void 0!==(exports="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){if("WebSocket"in window)return ReconnectingWebSocket.prototype.onopen=function(event){},ReconnectingWebSocket.prototype.onclose=function(event){},ReconnectingWebSocket.prototype.onconnecting=function(event){},ReconnectingWebSocket.prototype.onmessage=function(event){},ReconnectingWebSocket.prototype.onerror=function(event){},ReconnectingWebSocket.debugAll=!1,ReconnectingWebSocket.CONNECTING=WebSocket.CONNECTING,ReconnectingWebSocket.OPEN=WebSocket.OPEN,ReconnectingWebSocket.CLOSING=WebSocket.CLOSING,ReconnectingWebSocket.CLOSED=WebSocket.CLOSED,ReconnectingWebSocket;function ReconnectingWebSocket(url,protocols,options){var key,settings={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,binaryType:"arraybuffer"},encoder=(options=options||{},new TextEncoder("utf8"));for(key in settings)void 0!==options[key]?this[key]=options[key]:this[key]=settings[key];this.url=url,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var ws,self=this,forcedClose=!1,timedOut=!1,eventTarget=document.createElement("div");function generateEvent(s,args){var evt=document.createEvent("CustomEvent");return evt.initCustomEvent(s,!1,!1,args),evt}eventTarget.addEventListener("open",function(event){self.onopen(event)}),eventTarget.addEventListener("close",function(event){self.onclose(event)}),eventTarget.addEventListener("connecting",function(event){self.onconnecting(event)}),eventTarget.addEventListener("message",function(event){self.onmessage(event)}),eventTarget.addEventListener("error",function(event){self.onerror(event)}),this.addEventListener=eventTarget.addEventListener.bind(eventTarget),this.removeEventListener=eventTarget.removeEventListener.bind(eventTarget),this.dispatchEvent=eventTarget.dispatchEvent.bind(eventTarget),this.open=function(reconnectAttempt){if((ws=new WebSocket(self.url,protocols||[])).binaryType=this.binaryType,reconnectAttempt){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else eventTarget.dispatchEvent(generateEvent("connecting")),this.reconnectAttempts=0;(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",self.url);var localWs=ws,timeout=setTimeout(function(){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",self.url),timedOut=!0,localWs.close(),timedOut=!1},self.timeoutInterval);ws.onopen=function(event){clearTimeout(timeout),(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onopen",self.url),self.protocol=ws.protocol,self.readyState=WebSocket.OPEN,self.reconnectAttempts=0;var e=generateEvent("open");e.isReconnect=reconnectAttempt,reconnectAttempt=!1,eventTarget.dispatchEvent(e)},ws.onclose=function(event){var e;clearTimeout(void 0),ws=null,forcedClose?(self.readyState=WebSocket.CLOSED,eventTarget.dispatchEvent(generateEvent("close"))):(self.readyState=WebSocket.CONNECTING,(e=generateEvent("connecting")).code=event.code,e.reason=event.reason,e.wasClean=event.wasClean,eventTarget.dispatchEvent(e),reconnectAttempt||timedOut||((self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onclose",self.url),eventTarget.dispatchEvent(generateEvent("close"))),event=self.reconnectInterval*Math.pow(self.reconnectDecay,self.reconnectAttempts),setTimeout(function(){self.reconnectAttempts++,self.open(!0)},event>self.maxReconnectInterval?self.maxReconnectInterval:event))},ws.onmessage=function(event){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",self.url,event.data);var e=generateEvent("message");e.data=event.data,eventTarget.dispatchEvent(e)},ws.onerror=function(event){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onerror",self.url,event),eventTarget.dispatchEvent(generateEvent("error"))}},!0===this.automaticOpen&&this.open(!1),this.send=function(data){if(ws)return(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","send",self.url,data),ws.send(data);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.send_string=function(text){this.send(encoder.encode(text))},this.close=function(code,reason){void 0===code&&(code=1e3),forcedClose=!0,ws&&ws.close(code,reason)},this.refresh=function(){ws&&ws.close()}}})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,[]):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=exports)},function(module,exports,__webpack_require__){"use strict";var __webpack_require__=__webpack_require__(0),_ReconnectingWebSocket2=(__webpack_require__=__webpack_require__)&&__webpack_require__.__esModule?__webpack_require__:{default:__webpack_require__};window.SyncPlay=function(vNode,initobj,onconnected,onerror){var username,room,url,socket,conn_callback,videoNode,latencyCalculation,version="1.3.4",password=null,motd=null,clientRtt=0,clientIgnoringOnTheFly=0,serverIgnoringOnTheFly=0,seek=!1,stateChanged=!1,decoder=new TextDecoder("utf8"),shouldSync=!0;function messageHandler(message){for(var split_payload=decoder.decode(message.data).split("\r\n"),index=0;index<split_payload.length&&""!=split_payload[index];++index){var room,ignore,sevent,payload=JSON.parse(split_payload[index]);if(console.log("Server << "+JSON.stringify(payload)),payload.hasOwnProperty("Hello")&&(motd=payload.Hello.motd,conn_callback({connected:!0,motd:motd}),username!==payload.Hello.username&&(console.log("namechange",payload.Hello.username,username),username=payload.Hello.username,videoNode.dispatchEvent(new CustomEvent("namechange",{detail:{username:username}}))),sendRoomEvent("joined")),payload.hasOwnProperty("Error"))throw payload.Error;if(payload.hasOwnProperty("Set")&&payload.Set.hasOwnProperty("user"))for(var i in payload.Set.user)payload.Set.user[i].hasOwnProperty("event")&&(sevent=new CustomEvent("userlist",{detail:{user:Object.keys(payload.Set.user)[0],evt:Object.keys(payload.Set.user[i].event)[0]},bubbles:!0,cancelable:!0}),videoNode.dispatchEvent(sevent)),payload.Set.user[i].hasOwnProperty("file")&&Object.keys(payload.Set.user)[0]!=username&&(sevent=new CustomEvent("fileupdate",{detail:payload.Set,bubbles:!0,cancelable:!0}),videoNode.dispatchEvent(sevent));payload.hasOwnProperty("List")&&(room=Object.keys(payload.List)[0],sevent=new CustomEvent("listusers",{detail:payload.List[room],bubbles:!0,cancelable:!0}),videoNode.dispatchEvent(sevent)),payload.hasOwnProperty("State")&&(clientRtt=payload.State.ping.yourLatency,latencyCalculation=payload.State.ping.latencyCalculation,shouldSync?((room=payload.State.playstate).doSeek=!0,sevent=new CustomEvent("userevent",{detail:room,bubbles:!0,cancelable:!0}),videoNode.dispatchEvent(sevent),shouldSync=!1):(payload.State.hasOwnProperty("ignoringOnTheFly")&&((ignore=payload.State.ignoringOnTheFly).hasOwnProperty("server")?(serverIgnoringOnTheFly=ignore.server,clientIgnoringOnTheFly=0,stateChanged=!1):ignore.hasOwnProperty("client")&&ignore.client==clientIgnoringOnTheFly&&(clientIgnoringOnTheFly=0,stateChanged=!1)),payload.State.playstate.hasOwnProperty("setBy")&&null!=payload.State.playstate.setBy&&payload.State.playstate.setBy!=username&&(sevent=new CustomEvent("userevent",{detail:payload.State.playstate,bubbles:!0,cancelable:!0}),stateChanged||clientIgnoringOnTheFly||(stateChanged=!1,videoNode.dispatchEvent(sevent))),function(doSeek,latencyCalculation,stateChange){var state={};void 0!==stateChange&&(0!=clientIgnoringOnTheFly&&0==serverIgnoringOnTheFly||(state.playstate={},state.playstate.position=videoNode.currentTime,state.playstate.paused=videoNode.paused,doSeek&&(state.playstate.doSeek=doSeek,seek=!1)),state.ping={},null!=latencyCalculation&&(state.ping.latencyCalculation=latencyCalculation),state.ping.clientLatencyCalculation=(new Date).getTime()/1e3,state.ping.clientRtt=clientRtt,stateChange&&(clientIgnoringOnTheFly+=1),(serverIgnoringOnTheFly||clientIgnoringOnTheFly)&&(state.ignoringOnTheFly={},serverIgnoringOnTheFly&&(state.ignoringOnTheFly.server=serverIgnoringOnTheFly,serverIgnoringOnTheFly=0),clientIgnoringOnTheFly&&(state.ignoringOnTheFly.client=clientIgnoringOnTheFly)),send({State:state}))}(seek,latencyCalculation,stateChanged)))}}function sendRoomEvent(evt){var user=username,payload={Set:{user:{}}},userval={room:{name:room},event:{}};userval.event[evt]=!0,payload.Set.user[user]=userval,send(payload)}function sendHello(){var payload={Hello:{username:username,room:{name:room},version:version}};null!=password&&void 0!==window.md5&&(payload.Hello.password=window.md5(password)),send(payload),send({List:null})}function send(message){var jsonText=JSON.stringify(message);console.log("Client >> "+jsonText),socket.send_string(message=jsonText+"\r\n")}return function(initobj,onconnected,vnode){url=initobj.url,room=initobj.room,videoNode=vnode,username=initobj.name,conn_callback=onconnected,initobj.hasOwnProperty("password")&&(password=initobj.password)}(initobj,onconnected,vNode),{connect:function(){(socket=new _ReconnectingWebSocket2.default(url)).onopen=sendHello,socket.onmessage=messageHandler,socket.onerror=onerror},set_file:function(name,length,size_bytes){send({Set:{file:{duration:length,name:name,size:size_bytes}}})},disconnect:function(){sendRoomEvent("left"),socket.close()},playPause:function(){stateChanged=!0},seeked:function(){stateChanged=seek=!0}}}}]);